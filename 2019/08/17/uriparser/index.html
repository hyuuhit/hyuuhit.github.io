<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="hu yu's blog | Android | 服务端"><title>uriparser 解析处理URI | 属乌鸦的</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.4.0/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-129648993-1','auto');ga('send','pageview');
</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = 'https://hm.baidu.com/hm.js?' + '85d80db9310fa34ab2f7d34beeff589b';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();</script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">uriparser 解析处理URI</h1><a id="logo" href="/.">属乌鸦的</a><p class="description">无知 &amp; 聒噪</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">uriparser 解析处理URI</h1><div class="post-meta">Aug 17, 2019</div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#编译-amp-安装"><span class="toc-number">1.</span> <span class="toc-text">编译&amp;安装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RPM包安装"><span class="toc-number">1.1.</span> <span class="toc-text">RPM包安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#源码编译"><span class="toc-number">1.2.</span> <span class="toc-text">源码编译</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#例子"><span class="toc-number">2.</span> <span class="toc-text">例子</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#结构体"><span class="toc-number">3.</span> <span class="toc-text">结构体</span></a></li></ol></div></div><div class="post-content"><p>uriparser是一个用于解析与处理RFC3986标准URI的C语言库，这里简单记录其基本使用方式。</p>
<a id="more"></a>
<h2 id="编译-amp-安装"><a href="#编译-amp-安装" class="headerlink" title="编译&amp;安装"></a>编译&amp;安装</h2><h3 id="RPM包安装"><a href="#RPM包安装" class="headerlink" title="RPM包安装"></a>RPM包安装</h3><p>centos7下可以通过yum安装。</p>
<figure class="highlight shell"><figcaption><span>只需要运行库的话可以安装uriparser</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install uriparser</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><figcaption><span>还需要头文件的话可以安装uriparser-devel</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install uriparser-devel</span><br></pre></td></tr></table></figure>
<h3 id="源码编译"><a href="#源码编译" class="headerlink" title="源码编译"></a>源码编译</h3><p>如果需要静态链接，可以考虑源码编译。</p>
<p>uriparser代码托管于<a href="https://github.com/uriparser/uriparser" target="_blank" rel="noopener">github</a>，可以直接下载<a href="https://github.com/uriparser/uriparser/releases" target="_blank" rel="noopener">release代码</a>。</p>
<figure class="highlight shell"><figcaption><span>比如不需要文档和测试，只编译静态链接库，并指定安装目录前缀</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tar -xzvf uriparser-0.9.3.tar.gz &amp;&amp; \</span><br><span class="line">        cd uriparser-0.9.3 &amp;&amp; \</span><br><span class="line">        mkdir -p build &amp;&amp; cd build &amp;&amp; \</span><br><span class="line">        cmake -DURIPARSER_BUILD_TESTS=off -D URIPARSER_BUILD_DOCS=off -DBUILD_SHARED_LIBS=off -DCMAKE_INSTALL_PREFIX="$(INSTALL_DIR)" .. &amp;&amp; \</span><br><span class="line">        make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
<p>PS：编译需要cmake至少3.3版本，可以下载二进制安装包解压后将bin目录加入PATH环境变量直接使用，<a href="https://cmake.org/download/" target="_blank" rel="noopener">https://cmake.org/download/</a></p>
<h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><p>例子中可以看到，使用方式很简单，解析URI使用函数<code>uriParseSingleUriA</code>，如果解析成功，最后要调用<code>uriFreeUriMembersA</code>用以释放内存。<br>其他就是按照结构体构成读取解析后的各个URI结构。</p>
<figure class="highlight c"><figcaption><span>main.c</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;uriparser/Uri.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">print_text_range</span><span class="params">(<span class="keyword">char</span> *buf, <span class="keyword">size_t</span> buf_len, <span class="keyword">const</span> <span class="keyword">char</span> *first, <span class="keyword">const</span> <span class="keyword">char</span> *after_last)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">size_t</span> len = after_last - first + <span class="number">1</span> &gt; buf_len ? buf_len : after_last - first + <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">snprintf</span>(buf, len, <span class="string">"%s"</span>, first);</span><br><span class="line">    <span class="keyword">return</span> buf;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    UriUriA             uri;</span><br><span class="line">    UriPathSegmentA     *path;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span>          *error_pos;</span><br><span class="line">    <span class="keyword">char</span>                buf[<span class="number">256</span>];</span><br><span class="line">    <span class="keyword">char</span>                ip_buf[<span class="number">16</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (argc &lt; <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Usage: %s URI\n"</span>, argv[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"uri for parsing: \"%s\"\n"</span>, argv[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (uriParseSingleUriA(&amp;uri, argv[<span class="number">1</span>], &amp;error_pos) != URI_SUCCESS) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"parse uri failed, error pointer \"%s\"\n"</span>, error_pos);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%-20s%s\n"</span>, <span class="string">"scheme:"</span>, uri.scheme.first ?</span><br><span class="line">            print_text_range(buf, <span class="keyword">sizeof</span>(buf), uri.scheme.first, uri.scheme.afterLast) : <span class="literal">NULL</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%-20s%s\n"</span>, <span class="string">"userInfo:"</span>, uri.userInfo.first ?</span><br><span class="line">            print_text_range(buf, <span class="keyword">sizeof</span>(buf), uri.userInfo.first, uri.userInfo.afterLast) : <span class="literal">NULL</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%-20s%s\n"</span>, <span class="string">"hostText:"</span>, uri.hostText.first ?</span><br><span class="line">            print_text_range(buf, <span class="keyword">sizeof</span>(buf), uri.hostText.first, uri.hostText.afterLast) : <span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">if</span> (uri.hostData.ip4) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%-20s%s\n"</span>, <span class="string">"hostData.ip4"</span>,</span><br><span class="line">                inet_ntop(AF_INET, uri.hostData.ip4-&gt;data, ip_buf, <span class="keyword">sizeof</span>(ip_buf)));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%-20s%s\n"</span>, <span class="string">"portText:"</span>, uri.portText.first ?</span><br><span class="line">            print_text_range(buf, <span class="keyword">sizeof</span>(buf), uri.portText.first, uri.portText.afterLast) : <span class="literal">NULL</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%-20s%s\n"</span>, <span class="string">"query:"</span>, uri.query.first ?</span><br><span class="line">            print_text_range(buf, <span class="keyword">sizeof</span>(buf), uri.query.first, uri.query.afterLast) : <span class="literal">NULL</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%-20s%s\n"</span>, <span class="string">"fragment:"</span>, uri.fragment.first ?</span><br><span class="line">            print_text_range(buf, <span class="keyword">sizeof</span>(buf), uri.fragment.first, uri.fragment.afterLast) : <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (path = uri.pathHead; path != <span class="literal">NULL</span>; path = path-&gt;next) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%-20s%s\n"</span>, <span class="string">"pathHead:"</span>,</span><br><span class="line">                print_text_range(buf, <span class="keyword">sizeof</span>(buf), path-&gt;text.first, path-&gt;text.afterLast));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (path = uri.pathTail; path != <span class="literal">NULL</span>; path = path-&gt;next) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%-20s%s\n"</span>, <span class="string">"pathTail:"</span>,</span><br><span class="line">                print_text_range(buf, <span class="keyword">sizeof</span>(buf), path-&gt;text.first, path-&gt;text.afterLast));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    uriFreeUriMembersA(&amp;uri);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><figcaption><span>编译</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -g main.c -l uriparser</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><figcaption><span>运行输出</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">[huyu@localhost test_uriparser]$ ./a.out &quot;tcp://user:pass@host:443/a/b/cd?k=v&amp;k2=v2#frag&quot;</span><br><span class="line">uri for parsing: &quot;tcp://user:pass@host:443/a/b/cd?k=v&amp;k2=v2#frag&quot;</span><br><span class="line">scheme:             tcp</span><br><span class="line">userInfo:           user:pass</span><br><span class="line">hostText:           host</span><br><span class="line">portText:           443</span><br><span class="line">query:              k=v&amp;k2=v2</span><br><span class="line">fragment:           frag</span><br><span class="line">pathHead:           a</span><br><span class="line">pathHead:           b</span><br><span class="line">pathHead:           cd</span><br><span class="line">pathTail:           cd</span><br><span class="line">[huyu@localhost test_uriparser]$ ./a.out &quot;tcp://user:pass@192.168.1.1:443/a/b/cd?k=v&amp;k2=v2#frag&quot;</span><br><span class="line">uri for parsing: &quot;tcp://user:pass@192.168.1.1:443/a/b/cd?k=v&amp;k2=v2#frag&quot;</span><br><span class="line">scheme:             tcp</span><br><span class="line">userInfo:           user:pass</span><br><span class="line">hostText:           192.168.1.1</span><br><span class="line">hostData.ip4        192.168.1.1</span><br><span class="line">portText:           443</span><br><span class="line">query:              k=v&amp;k2=v2</span><br><span class="line">fragment:           frag</span><br><span class="line">pathHead:           a</span><br><span class="line">pathHead:           b</span><br><span class="line">pathHead:           cd</span><br><span class="line">pathTail:           cd</span><br></pre></td></tr></table></figure>
<h2 id="结构体"><a href="#结构体" class="headerlink" title="结构体"></a>结构体</h2><p>uriparser的头文件中使用宏定义包装了结构体和函数的命名，宏如下。功能为字符串拼接，比如<code>URI_TYPE(Uri)</code>在展开后为<code>UriUriA</code></p>
<figure class="highlight c"><figcaption><span>结构体及函数命名宏</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">undef</span> URI_FUNC</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> URI_FUNC(x) uri##x##A</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">undef</span> URI_TYPE</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> URI_TYPE(x) Uri##x##A</span></span><br></pre></td></tr></table></figure>
<p>了解过宏定义就可以看主要结构体了</p>
<figure class="highlight c"><figcaption><span>UriUriA</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Represents an RFC 3986 %URI.</span></span><br><span class="line"><span class="comment"> * Missing components can be &#123;NULL, NULL&#125; ranges.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @see uriFreeUriMembersA</span></span><br><span class="line"><span class="comment"> * @see uriFreeUriMembersMmA</span></span><br><span class="line"><span class="comment"> * @see UriParserStateA</span></span><br><span class="line"><span class="comment"> * @since 0.3.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> struct <span class="title">URI_TYPE</span><span class="params">(UriStruct)</span> </span>&#123;</span><br><span class="line">    URI_TYPE(TextRange) scheme; <span class="comment">/**&lt; Scheme (e.g. "http") */</span></span><br><span class="line">    URI_TYPE(TextRange) userInfo; <span class="comment">/**&lt; User info (e.g. "user:pass") */</span></span><br><span class="line">    URI_TYPE(TextRange) hostText; <span class="comment">/**&lt; Host text (set for all hosts, excluding square brackets) */</span></span><br><span class="line">    URI_TYPE(HostData) hostData; <span class="comment">/**&lt; Structured host type specific data */</span></span><br><span class="line">    URI_TYPE(TextRange) portText; <span class="comment">/**&lt; Port (e.g. "80") */</span></span><br><span class="line">    URI_TYPE(PathSegment) * pathHead; <span class="comment">/**&lt; Head of a linked list of path segments */</span></span><br><span class="line">    URI_TYPE(PathSegment) * pathTail; <span class="comment">/**&lt; Tail of the list behind pathHead */</span></span><br><span class="line">    URI_TYPE(TextRange) query; <span class="comment">/**&lt; Query without leading "?" */</span></span><br><span class="line">    URI_TYPE(TextRange) fragment; <span class="comment">/**&lt; Query without leading "#" */</span></span><br><span class="line">    UriBool absolutePath; <span class="comment">/**&lt; Absolute path flag, distincting "a" and "/a";</span></span><br><span class="line"><span class="comment">                            always &lt;c&gt;URI_FALSE&lt;/c&gt; for URIs with host */</span></span><br><span class="line">    UriBool owner; <span class="comment">/**&lt; Memory owner flag */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> * reserved; <span class="comment">/**&lt; Reserved to the parser */</span></span><br><span class="line">&#125; URI_TYPE(Uri); <span class="comment">/**&lt; @copydoc UriUriStructA */</span></span><br></pre></td></tr></table></figure>
<p><code>UriUriA</code>中大量出现的成员类型<code>URI_TYPE(TextRange)</code>定义如下，读取方式参考例子代码。</p>
<figure class="highlight c"><figcaption><span>URI_TYPE(TextRange)</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Specifies a range of characters within a string.</span></span><br><span class="line"><span class="comment"> * The range includes all characters from &lt;c&gt;first&lt;/c&gt;</span></span><br><span class="line"><span class="comment"> * to one before &lt;c&gt;afterLast&lt;/c&gt;. So if both are</span></span><br><span class="line"><span class="comment"> * non-NULL the difference is the length of the text range.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @see UriUriA</span></span><br><span class="line"><span class="comment"> * @see UriPathSegmentA</span></span><br><span class="line"><span class="comment"> * @see UriHostDataA</span></span><br><span class="line"><span class="comment"> * @since 0.3.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> struct <span class="title">URI_TYPE</span><span class="params">(TextRangeStruct)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> URI_CHAR * first; <span class="comment">/**&lt; Pointer to first character */</span></span><br><span class="line">    <span class="keyword">const</span> URI_CHAR * afterLast; <span class="comment">/**&lt; Pointer to character after the last one still in */</span></span><br><span class="line">&#125; URI_TYPE(TextRange); <span class="comment">/**&lt; @copydoc UriTextRangeStructA */</span></span><br></pre></td></tr></table></figure>
<p><code>UriUriA</code>中<code>hostData</code>成员在域名是合法的IPV4地址时，uriparser会帮助解析为网络序的IPV4地址值，参考例子代码对hostData的处理。</p>
<p><code>URI_TYPE(PathSegment)</code>代表了路径的每一段，链表结构。<br><figure class="highlight c"><figcaption><span>URI_TYPE(PathSegment)</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Represents a path segment within a %URI path.</span></span><br><span class="line"><span class="comment"> * More precisely it is a node in a linked</span></span><br><span class="line"><span class="comment"> * list of path segments.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @see UriUriA</span></span><br><span class="line"><span class="comment"> * @since 0.3.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> struct <span class="title">URI_TYPE</span><span class="params">(PathSegmentStruct)</span> </span>&#123;</span><br><span class="line">    URI_TYPE(TextRange) text; <span class="comment">/**&lt; Path segment name */</span></span><br><span class="line">    <span class="function">struct <span class="title">URI_TYPE</span><span class="params">(PathSegmentStruct)</span> * next</span>; <span class="comment">/**&lt; Pointer to the next path segment in the list, can be NULL if last already */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> * reserved; <span class="comment">/**&lt; Reserved to the parser */</span></span><br><span class="line">&#125; URI_TYPE(PathSegment); <span class="comment">/**&lt; @copydoc UriPathSegmentStructA */</span></span><br></pre></td></tr></table></figure></p>
</div><div class="tags"><a href="/tags/工具/">工具</a></div><div class="post-nav"><a class="pre" href="/2019/08/20/bash-invocation/">bash 调用方式与配置文件</a><a class="next" href="/2019/05/06/noblock-rabbitmq-c/">rabbitmq-c 非阻塞订阅</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://www.hyuuhit.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/libvirt/">libvirt</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/suricata/">suricata</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/工具/" style="font-size: 15px;">工具</a> <a href="/tags/Android/" style="font-size: 15px;">Android</a> <a href="/tags/vmware/" style="font-size: 15px;">vmware</a> <a href="/tags/数据结构/" style="font-size: 15px;">数据结构</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2024/05/26/dirpro-bug-analysis/">一次无源码Linux内核模块bug分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2024/05/13/elrepo-not-for-production-use/">为什么生产环境服务器不应该使用ELRepo内核</a></li><li class="post-list-item"><a class="post-list-link" href="/2024/04/29/memory-consistency-model-memory-barrier-and-sychronization/">内存一致性模型、内存屏障与同步</a></li><li class="post-list-item"><a class="post-list-link" href="/2024/04/11/rcu-usage/">抢占式RCU与RCU使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/09/16/tc-tbf-qdisc/">tc tbf qdisc 令牌桶过滤器限速队列</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/08/08/function-call-stack/">gdb查看寄存器及内存数据与函数调用栈分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/11/16/libpcap-cutoff-captured-packet/">libpcap在libvirt虚拟化环境下捕获数据包不完整的一种情况分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/08/27/bash-audit/">一种简单的bash审计方法</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/08/20/bash-invocation/">bash 调用方式与配置文件</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/08/17/uriparser/">uriparser 解析处理URI</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2024 <a href="/." rel="nofollow">属乌鸦的.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>